# 老師介面集成測試指南

## 📋 測試前準備

### 1. 檢查環境
```bash
# 檢查 Node.js 版本
node --version  # 應該 >= 14.0.0

# 檢查 npm 版本
npm --version   # 應該 >= 6.0.0
```

### 2. 數據庫準備
確保 MySQL 運行在 localhost:3305
```bash
# 測試連接
mysql -u root -p626Angel -h localhost -P 3305 ai_ta_db

# 驗證表結構
SHOW TABLES;
DESCRIBE classes;
DESCRIBE class_students;
DESCRIBE questions;
```

### 3. 啟動服務
```bash
# 終端 1 - 後端
cd backend
node server.js

# 終端 2 - 前端
cd frontend
npm run dev
```

---

## ✅ 測試用例

### 測試套件 1：班級管理基本功能

#### TC1.1 - 建立班級
**步驟：**
1. 以老師身份登入（admin@test.com / admin123）
2. 點擊左側菜單「班級管理」
3. 點擊「建立新班級」按鈕
4. 填寫以下資訊：
   - 班級名稱：「2年3班」
   - 班級描述：「這是測試班級」
   - 科目：「數學」
5. 點擊「建立班級」按鈕

**預期結果：**
- ✅ 班級成功建立
- ✅ 頁面更新並顯示新班級卡片
- ✅ 班級卡片顯示正確的名稱和描述
- ✅ 學生數顯示為 0

**驗證：**
```sql
SELECT * FROM classes WHERE class_name='2年3班';
```
應該返回一行新記錄。

---

#### TC1.2 - 查看班級列表
**步驟：**
1. 進入班級管理頁面
2. 觀察班級列表

**預期結果：**
- ✅ 所有老師的班級都顯示在列表中
- ✅ 每個班級卡片顯示：班級名稱、描述、學生數、建立日期
- ✅ 卡片上有編輯（✏️）和刪除（🗑️）按鈕
- ✅ 底部有「查看學生」按鈕

---

#### TC1.3 - 查看班級學生
**步驟：**
1. 在班級卡片上點擊「查看學生」
2. 觀察彈出的模態框

**預期結果：**
- ✅ 模態框顯示班級名稱
- ✅ 表格顯示班級中的所有學生
- ✅ 顯示欄位：學號、姓名、信箱、加入日期、操作
- ✅ 如果班級沒有學生，顯示「此班級還沒有學生」

---

#### TC1.4 - 刪除班級
**步驟：**
1. 在班級卡片上點擊「🗑️」按鈕
2. 在確認對話框點擊「確認」

**預期結果：**
- ✅ 班級被刪除
- ✅ 班級卡片從列表消失
- ✅ 刪除成功提示顯示

**驗證：**
```sql
SELECT * FROM classes WHERE class_name='2年3班';
```
應該返回 0 行。

---

### 測試套件 2：題目匯入功能

#### TC2.1 - 下載匯入模板
**步驟：**
1. 進入「匯入題目」頁面
2. 在「下載模板」部分點擊「📥 下載 Excel 模板」

**預期結果：**
- ✅ 下載 CSV 檔案（題目匯入模板.csv）
- ✅ 檔案包含正確的欄位頭：question_text, answer_text, solution_text, difficulty
- ✅ 包含 2 個範例題目

---

#### TC2.2 - 上傳和預覽題目
**步驟：**
1. 進入「匯入題目」頁面
2. 準備 CSV 檔案，內容如下：
```csv
question_text,answer_text,solution_text,difficulty
計算 2+2,4,2+2=4,easy
計算 3×5,15,3乘以5等於15,medium
解方程 x=10,10,x等於10,hard
```
3. 拖拽或點擊選擇該檔案
4. 觀察預覽

**預期結果：**
- ✅ 檔案成功上傳並解析
- ✅ 預覽表格顯示前 10 條題目
- ✅ 顯示總題目數量
- ✅ 科目和單元選擇器可用
- ✅ 難度級別顯示正確

---

#### TC2.3 - 匯入題目
**步驟：**
1. 在預覽頁面，從下拉菜單選擇：
   - 科目：「數學」
   - 單元：「一元一次方程式」
2. 預設難度保持「中等」
3. 點擊「匯入」按鈕

**預期結果：**
- ✅ 題目成功匯入
- ✅ 出現成功提示「成功匯入 3 條題目」
- ✅ 3 秒後自動清除預覽
- ✅ 頁面返回初始狀態

**驗證：**
```sql
SELECT COUNT(*) FROM questions 
WHERE unit_id = (SELECT id FROM units WHERE unit_name='一元一次方程式');
```
應該看到題目數增加。

---

#### TC2.4 - 驗證匯入的題目
**步驟：**
```sql
SELECT * FROM questions 
WHERE unit_id = (SELECT id FROM units WHERE unit_name='一元一次方程式')
ORDER BY created_at DESC 
LIMIT 3;
```

**預期結果：**
- ✅ 題目內容正確（question_text）
- ✅ 答案正確（answer_text）
- ✅ 解析內容正確（solution_text）
- ✅ 難度級別正確（difficulty）

---

#### TC2.5 - 驗證難度覆蓋
**步驟：**
1. 上傳檔案但不設置難度欄位
2. 選擇科目和單元
3. 將預設難度改為「困難」
4. 匯入題目

**預期結果：**
- ✅ 所有題目的難度都設置為「困難」
- ✅ 如果某些題目在檔案中有難度值，則使用檔案中的值
- ✅ 檔案中沒有難度值的題目使用預設難度

---

### 測試套件 3：邊界和錯誤處理

#### TC3.1 - 無效的科目和單元
**步驟：**
1. 上傳有效的題目檔案
2. 不選擇科目或單元
3. 嘗試點擊「匯入」按鈕

**預期結果：**
- ✅ 「匯入」按鈕被禁用
- ✅ 顯示提示「請選擇科目和單元」

---

#### TC3.2 - 超大檔案
**步驟：**
1. 嘗試上傳大小超過 5MB 的檔案

**預期結果：**
- ✅ 顯示錯誤提示「檔案大小不能超過 5MB」
- ✅ 檔案不被上傳

---

#### TC3.3 - 無效檔案格式
**步驟：**
1. 嘗試上傳 .txt 或 .docx 檔案

**預期結果：**
- ✅ 檔案選擇器只顯示允許的格式
- ✅ 如果強制上傳，顯示格式錯誤

---

#### TC3.4 - 空白班級名稱
**步驟：**
1. 點擊「建立新班級」
2. 不填寫班級名稱
3. 嘗試點擊「建立班級」

**預期結果：**
- ✅ 瀏覽器顯示必填欄位驗證提示
- ✅ 表單不提交

---

### 測試套件 4：響應式設計

#### TC4.1 - 手機視圖
**步驟：**
1. 在 Chrome DevTools 中選擇 iPhone 12 視圖 (390x844)
2. 進入班級管理頁面
3. 進入題目匯入頁面

**預期結果：**
- ✅ 所有元素正確縮放
- ✅ 導航菜單可用
- ✅ 按鈕易於點擊
- ✅ 表格水平滾動

---

#### TC4.2 - 平板視圖
**步驟：**
1. 在 Chrome DevTools 中選擇 iPad 視圖 (768x1024)
2. 進入班級管理頁面

**預期結果：**
- ✅ 班級卡片使用 2 列佈局
- ✅ 所有內容清晰可讀

---

### 測試套件 5：數據持久化

#### TC5.1 - 頁面刷新後數據持久
**步驟：**
1. 建立班級「測試班」
2. 導入 3 條題目
3. 刷新頁面（F5）
4. 進入班級管理頁面

**預期結果：**
- ✅ 班級仍然存在
- ✅ 班級資訊正確
- ✅ 學生數字正確

---

#### TC5.2 - 多個老師獨立的班級
**步驟：**
1. 創建兩個老師帳戶
2. 每個老師都建立班級
3. 驗證互不影響

**預期結果：**
- ✅ 每個老師只能看到自己的班級
- ✅ 學生只能看到自己所在的班級

---

## 🔍 性能測試

### PT1 - 批量班級列表
**步驟：**
1. 在數據庫中創建 100 個班級
2. 進入班級管理頁面

**預期結果：**
- ✅ 頁面在 2 秒內加載
- ✅ 所有班級都顯示
- ✅ 列表滾動流暢

---

### PT2 - 大量題目匯入
**步驟：**
1. 準備包含 500 條題目的 CSV 檔案
2. 點擊「匯入」

**預期結果：**
- ✅ 匯入在 10 秒內完成
- ✅ 所有題目正確匯入
- ✅ 無超時或斷開連接錯誤

---

## 📊 測試結果記錄

### 測試執行表

| 測試用例 | 預期結果 | 實際結果 | 狀態 | 備註 |
|---------|---------|---------|------|------|
| TC1.1 | ✅ | | ⚪ | |
| TC1.2 | ✅ | | ⚪ | |
| TC1.3 | ✅ | | ⚪ | |
| TC1.4 | ✅ | | ⚪ | |
| TC2.1 | ✅ | | ⚪ | |
| TC2.2 | ✅ | | ⚪ | |
| TC2.3 | ✅ | | ⚪ | |
| TC2.4 | ✅ | | ⚪ | |
| TC2.5 | ✅ | | ⚪ | |
| TC3.1 | ✅ | | ⚪ | |
| TC3.2 | ✅ | | ⚪ | |
| TC3.3 | ✅ | | ⚪ | |
| TC3.4 | ✅ | | ⚪ | |
| TC4.1 | ✅ | | ⚪ | |
| TC4.2 | ✅ | | ⚪ | |
| TC5.1 | ✅ | | ⚪ | |
| TC5.2 | ✅ | | ⚪ | |
| PT1 | ✅ | | ⚪ | |
| PT2 | ✅ | | ⚪ | |

**圖例：** ✅=通過 ❌=失敗 ⚪=未測試

---

## 🐛 問題報告模板

如果發現 bug，請使用以下模板報告：

```
**測試用例：** TC1.1
**標題：** 建立班級時出現 500 錯誤
**重現步驟：**
1. 進入班級管理
2. 點擊建立新班級
3. 填寫班級名稱「2年3班」
4. 點擊建立

**預期結果：**
班級成功建立

**實際結果：**
顯示 500 Server Error

**錯誤信息：**
[粘貼瀏覽器控制台的錯誤]

**環境：**
- 瀏覽器：Chrome 120
- 系統：Windows 11
- 時間：2025-12-23 14:30

**附件：**
[截圖或錄影]
```

---

## ✨ 測試完成清單

- [ ] 所有班級管理功能測試通過
- [ ] 所有題目匯入功能測試通過
- [ ] 錯誤處理測試通過
- [ ] 響應式設計測試通過
- [ ] 數據持久化測試通過
- [ ] 性能測試通過
- [ ] 跨瀏覽器測試通過
- [ ] 無 JavaScript 控制台錯誤
- [ ] 無 API 錯誤 (4xx, 5xx)
- [ ] 用戶體驗驗證完成

---

**測試執行日期：** _______________
**測試人員：** _______________
**簽名：** _______________

---

**文檔版本：** 1.0
**最後更新：** 2025-12-23
